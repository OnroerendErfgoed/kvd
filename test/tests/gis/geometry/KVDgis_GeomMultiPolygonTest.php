<?php


class KVDgis_GeomMultiPolygonTest extends PHPUnit_Framework_TestCase
{
    private $testMultiPoly;
    
    private $testPolygon1;
    
    private $testPolygon2;
    
    function setUp()
    {
        $this->testMultiPoly = new KVDgis_GeomMultiPolygon( );

        $this->testPolygon1 = new KVDgis_GeomPolygon;
        $this->testPolygon1->setGeometryFromText( 'POLYGON((178000.25 212000.35, 178100.50 212003.55, 180560 212100))' );
        
        $this->testPolygon2 = new KVDgis_GeomPolygon;
        $this->testPolygon2->setGeometryFromText( 'POLYGON((158000.25 200000.35, 158105.50 200203.55, 160560 200100))' );
    }

    function tearDown()
    {
        $this->testMultiPoly = null;
    }

    function testIsEmpty( )
    {
        $this->assertEquals( -1, $this->testMultiPoly->getSrid( ) );
        $this->assertTrue( $this->testMultiPoly->isEmpty( ) ); 
    }

    function testSetSrid()
    {
        $this->testMultiPoly->setSrid(5000);
        $this->assertEquals( 5000, $this->testMultiPoly->getSrid() );    
    }

    function testSetPolygons( )
    {
        $this->testMultiPoly->setPolygons( array( $this->testPolygon1, $this->testPolygon2 ) );
        $this->assertEquals($this->testMultiPoly->getAsText( ),
                                'MULTIPOLYGON(((178000.25 212000.35, 178100.50 212003.55, 180560 212100)), ((158000.25 200000.35, 158105.50 200203.55, 160560 200100)))' );
    }
    
    function testAddPolygon( )
    {
        $this->testMultiPoly->addPolygon( $this->testPolygon1 );
        $this->assertEquals($this->testMultiPoly->getAsText( ),
                           'MULTIPOLYGON(((178000.25 212000.35, 178100.50 212003.55, 180560 212100)))' );
    }
    

    function testConstructor( )
    {
        $testMultiPoly = new KVDgis_GeomMultiPolygon( 31300 , array($this->testPolygon1, $this->testPolygon2));
        $this->assertEquals( $testMultiPoly->getAsText( ) , 
                            'MULTIPOLYGON(((178000.25 212000.35, 178100.50 212003.55, 180560 212100)), ((158000.25 200000.35, 158105.50 200203.55, 160560 200100)))' );
        $this->assertEquals( $testMultiPoly->getSrid( ) , 31300 );
    }
    
    function testSetGeometryFromText()
    {
        $values = array ( 'MULTIPOLYGON(((178000.25 212000.35, 178100.50 212003.55, 180560 212100)), ((158000.25 200000.35, 158105.50 200203.55, 160560 200100), (160 250, 400 500, 210 321)))', 'EMPTY' );
        foreach ( $values as $v ) {
            $this->testMultiPoly->setGeometryFromText($v);
            $this->assertEquals( $v, $this->testMultiPoly->getAsText( ) );
        }
    }

    function testGeometryToString()
    {
        $this->testMultiPoly->setGeometryFromText(
                            'MULTIPOLYGON(((178000.25 212000.35, 178100.50 212003.55, 180560 212100)), ((158000.25 200000.35, 158105.50 200203.55, 160560 200100), (160 250, 400 500, 210 321)))'
                                                );
        $this->assertEquals( (string) $this->testMultiPoly, 
                            'MULTIPOLYGON(((178000.25 212000.35, 178100.50 212003.55, 180560 212100)), ((158000.25 200000.35, 158105.50 200203.55, 160560 200100), (160 250, 400 500, 210 321)))'
                            );
    }

    /**
     * testSetIllegalGeometryFromText 
     * 
     * @expectedException   InvalidArgumentException
     * @access public
     * @return void
     */
    function testSetIllegalGeometryFromText()
    {
        $this->testMultiPoly->setGeometryFromText('MULTIPOINT(178000 212000)');    
    }

    function testGetAsJson( )
    {
        $this->testMultiPoly->setGeometryFromText(
            'MULTIPOLYGON(((178000.25 212000.35, 178100.50 212003.55, 180560 212100)), 
                          ((158000.25 200000.35, 158105.50 200203.55, 160560 200100), (160 250, 400 500, 210 321)))');
        $js = new stdClass( );
        $js->type = 'MultiPolygon';
        $js->coordinates = array( 
            array(array(array(178000.25, 212000.35), array(178100.50, 212003.55), array(180560, 212100))), 
            array(array(array(158000.25, 200000.35), array(158105.50, 200203.55), array(160560, 200100)), 
                  array(array(160, 250), array(400, 500), array(210, 321)))
        );
        $this->assertEquals( $js, $this->testMultiPoly->getAsJson(false) );
    }

    /**
     * testVeryLargePolygon 
     * 
     * Testen van een multipoly die problemen gaf op de OEPS dev versie.
     * Uiteindelijk bleek het probleem te liggen in een aantal overbodige 
     * spaties. Zie de volgende testcase voor een test hierrond.
     * @access public
     * @return void
     */
    function testVeryLargePolygon(  )
    {
        $this->testMultiPoly->setGeometryFromText( 'MULTIPOLYGON(((174595.03894043 184450.282165527,174633.30065918 184234.019287109,174836.255310059 184205.738708496,174842.909423828 184135.869140625,174882.835021973 184075.980957031,174922.760437012 184077.644592285,174946.050292969 184039.382629395,175014.256225586 184031.064880371,175072.480957031 183991.139282227,175110.742736816 183924.596984863,175117.397033691 183883.007995605,175102.424926758 183841.418945312,175144.013977051 183761.567993164,175333.659912109 183783.194213867,175509.997375488 183848.073059082,175571.549194336 183859.718078613,175589.848388672 183778.203735352,175704.634033203 183723.306030273,175776.167236328 183700.016174316,175947.513793945 183656.76373291,175952.504516602 183247.527648926,175877.644470215 183180.985351562,175895.943603516 182959.731567383,175879.307861328 182861.581604004,175897.607055664 182834.964477539,175897.607055664 182708.533996582,175970.803649902 182695.225524902,176035.682739258 182680.253417969,176092.243652344 182691.898254395,176152.131835938 182718.515380859,176170.431030273 182718.515380859,176268.581176758 182608.720214844,176311.83380127 182582.10333252,176343.44140625 182577.112609863,176424.955810547 182362.513183594,176478.189880371 182345.877624512,176563.03137207 182274.344421387,176626.246826172 182184.512268066,176601.293334961 182083.035095215,176581.330749512 181979.894226074,176601.293334961 181938.305236816,176393.348205566 181860.117858887,176400.002563477 181805.220397949,176353.422851562 181791.91192627,176255.272705078 181810.21105957,176163.776916504 181833.500976562,176067.290161133 181843.482116699,176037.346191406 181848.472839355,175974.13092041 181835.164367676,175890.952880859 181840.155090332,175812.765563965 181871.762695312,175794.466430664 181883.407714844,175772.83996582 181918.342407227,175757.867858887 181928.323791504,175686.334838867 181900.043273926,175856.018005371 181504.115844727,175741.23236084 181415.94708252,175832.728149414 181281.198669434,175964.149536133 181242.936706543,176015.719970703 181227.964782715,176065.62677002 181262.899475098,176185.403137207 181073.253540039,176398.338928223 181109.851867676,176371.721984863 180993.402587891,176719.40625 181068.262878418,176789.275817871 181048.300048828,176785.948547363 181101.534118652,176917.369934082 181108.188232422,176915.706298828 181154.767944336,176968.940368652 181154.767944336,176845.836730957 181346.077514648,176855.818115234 181376.021484375,176817.556152344 181399.311340332,176847.500366211 181459.199523926,177027.164916992 181359.385986328,177067.090270996 181342.750488281,177105.352233887 181452.545410156,177170.231140137 181657.163452148,177218.474487305 181647.182067871,177248.418457031 181668.808288574,177321.615356445 181647.182067871,177341.577880859 181683.780395508,177466.344970703 181628.88293457,177423.092529297 181539.050537109,177502.94329834 181484.153076172,177499.616210938 181342.750488281,177619.392578125 181362.71307373,177804.047851562 181475.835266113,177877.244445801 181524.078674316,177938.796264648 181467.51751709,178033.619384766 181432.582641602,178021.974304199 181262.899475098,178229.919433594 181252.91809082,178268.181396484 181229.628234863,178229.919433594 181053.290771484,178323.078857422 181044.972961426,178466.145080566 181010.038330078,178595.902832031 181033.327941895,178617.529052734 181049.963684082,178632.501159668 181086.562011719,178692.389587402 181099.870483398,178728.987915039 181096.543395996,178768.913269043 181099.870483398,178817.156433105 181133.141723633,178892.016662598 181136.468811035,178945.250732422 181139.795837402,179013.456665039 181148.113830566,179070.017822266 181178.057800293,179119.924560547 181166.412963867,179201.438964844 181149.77722168,179264.654418945 181143.12310791,179307.906860352 181149.77722168,179342.841796875 181164.749328613,179409.384338379 181159.758666992,179480.917297363 181149.77722168,179540.805480957 181144.786743164,179574.076721191 181169.74005127,179614.00213623 181184.712158203,179668.899597168 181184.712158203,179718.80657959 181219.646850586,179773.704101562 181244.600341797,179821.94720459 181262.899475098,179911.779602051 181297.834411621,179971.667785645 181301.161437988,180039.873718262 181319.460632324,180114.734008789 181344.413879395,180214.547546387 181382.675842285,180281.090087891 181409.292785645,180314.361328125 181414.283447266,180362.604736328 181450.881774902,180432.474060059 181469.180969238,180477.390380859 181492.470825195,180553.9140625 181535.723449707,180647.073486328 181555.686279297,180745.223632812 181608.92010498,180811.765930176 181610.583740234,180876.645019531 181602.265991211,180886.626220703 181580.639526367,180991.430725098 181575.648864746,181134.496948242 181570.65814209,181176.0859375 181600.602355957,181244.291870117 181640.527709961,181325.806274414 181657.163452148,181400.666564941 181662.154174805,181452.236999512 181653.836181641,181527.097290039 181693.761779785,181522.106567383 181715.388000488,181631.901550293 181717.051635742,181631.901550293 181738.677856445,181789.939819336 181750.322937012,181833.192504883 181803.556762695,181863.136474609 181830.17364502,181962.950256348 181850.136474609,181971.268005371 181915.015319824,182225.79284668 181778.60345459,182255.736816406 181760.304077148,182338.914855957 181765.294799805,182460.354858398 181831.837280273,182706.561950684 181615.574462891,182866.263916016 181482.489379883,182959.423095703 181440.900634766,183197.312438965 181397.647949219,183345.36932373 181347.741149902,183460.154968262 181287.852966309,183543.333007812 181173.067138672,183599.894165039 181064.935791016,183699.707946777 180916.878845215,183766.250244141 180860.317749023,183975.858947754 180788.784545898,184049.055603027 180762.167602539,184103.953063965 180728.896362305,184118.925170898 180707.270141602,184142.215026855 180564.203918457,184170.495605469 180491.007263184,183892.680908203 180459.399414062,183716.343444824 180399.511230469,183385.29473877 181031.664550781,183092.508178711 180888.598327637,183115.798034668 180747.195495605,183142.414916992 180657.363342285,183072.545349121 180545.904724121,183107.480041504 180532.596313477,183184.003967285 180384.539367676,183243.892150879 180337.959655762,183420.229614258 180442.763916016,183523.370422363 180303.024719238,183653.128234863 180183.248413086,183762.923156738 180038.518737793,183776.231628418 180023.546630859,183579.931335449 179868.835388184,183633.165405273 179734.086914062,183686.399230957 179705.806396484,183777.895263672 179745.731994629,183932.606323242 179654.23614502,183683.07220459 179178.457580566,183661.445983887 179100.270202637,183626.511047363 179050.363464355,183659.782348633 178993.802307129,183521.706787109 178689.370727539,183554.978088379 178577.912109375,183563.295837402 178501.388427734,183554.978088379 178433.182250977,183639.819519043 178250.190673828,183827.802062988 178167.012634277,183884.36315918 178142.059143066,183867.727416992 178097.143066406,183919.297851562 178090.488952637,183979.186035156 178058.881103516,184022.438659668 178050.563354492,184083.990478516 178062.208129883,184142.215026855 178103.797363281,184238.701538086 178142.059143066,184338.515136719 178181.984741211,184428.347473145 178231.891479492,184491.562744141 178233.555175781,184563.095947266 178265.162780762,184627.974853516 178238.545654297,184724.461303711 178140.395690918,184734.442749023 178127.087219238,184761.059631348 178135.405029297,184884.163269043 177980.693725586,184920.76159668 177969.048950195,184983.976867676 177952.413208008,185013.921020508 177947.422485352,185082.12701416 177925.796264648,185165.305053711 177899.179321289,185240.165283203 177857.590332031,185323.343322754 177817.664733887,185366.59576416 177801.02923584,185406.521362305 177579.775634766,185211.884765625 177558.149230957,184987.303894043 177855.926696777,184965.67767334 177845.9453125,184954.032897949 177787.72076416,184766.050354004 177817.664733887,184759.395996094 177801.02923584,184677.881591797 177792.711425781,184676.217956543 177850.935974121,184578.068054199 177852.599609375,184481.581298828 177839.29119873,184403.393981934 177807.683532715,184361.804992676 177792.711425781,184263.655029297 177761.103820801,184270.309143066 177741.141052246,184125.579284668 177691.23425293,184120.588806152 177593.084106445,184128.906616211 177491.606933594,184138.887756348 177381.811706543,184217.075317383 177353.53137207,184266.982116699 177353.53137207,184355.150878906 177321.923522949,184381.76776123 177310.278747559,184376.777038574 177345.213378906,184484.908630371 177346.877075195,184574.740783691 177351.867736816,184593.039916992 177348.540710449,184599.694274902 177273.680419922,184518.179870605 177240.409118652,184483.244995117 177217.119262695,184486.572021484 177192.165771484,184581.395080566 177178.857299805,184609.67565918 177195.493041992,184681.208679199 177208.801513672,184721.134277344 177208.801513672,184762.723266602 177230.427734375,184804.312316895 177232.091369629,184864.200500488 177233.755004883,184594.703552246 177085.697875977,184584.722167969 177145.58605957,184443.319580078 177117.305725098,184326.870300293 177077.380126953,184340.178771973 177004.18347168,184153.859863281 176945.95892334,184197.112548828 176861.117248535,183969.204650879 176723.041748047,183937.596984863 176716.387390137,183846.101196289 176649.845092773,183809.502868652 176634.87298584,183814.493591309 176609.919494629,183891.017272949 176515.096618652,183802.848571777 176433.582275391,183839.446838379 176390.329589844,183769.577270508 176328.777770996,183721.33416748 176367.039733887,183621.520385742 176209.001403809,183579.931335449 176245.599731445,183488.435546875 176135.804748535,183471.800048828 176050.96307373,183500.080566406 176047.636047363,183513.389038086 176001.056335449,183496.753295898 175932.850341797,183558.305114746 175784.793457031,183603.221191406 175711.596618652,183611.53894043 175636.73651123,183661.445983887 175528.604980469,183681.408569336 175503.651489258,183679.745117188 175453.744689941,183714.67980957 175400.510864258,183737.969665527 175380.548095703,183774.567993164 175322.323547363,183806.175598145 175275.743835449,183829.465454102 175257.444641113,183871.054504395 175185.911437988,183899.335021973 175079.44354248,183925.952209473 175019.555358887,183949.241821289 174943.031677246,183985.840393066 174954.676452637,184047.391967773 174936.377319336,184113.934509277 174889.797607422,184157.187133789 174841.554199219,184160.514221191 174801.628845215,184150.532836914 174763.366882324,184095.635314941 174721.777893066,184108.943786621 174698.488037109,184168.831970215 174691.833862305,184212.084655762 174675.198120117,184232.047180176 174613.64654541,184257.000732422 174661.889709473,184266.982116699 174726.768554688,184325.206665039 174675.198120117,184383.431396484 174733.422912598,184581.395080566 174849.872192383,184704.498535156 174636.936401367,184608.012023926 174616.973632812,184489.899291992 174600.33807373,184433.338195801 174600.33807373,184426.683837891 174535.459228516,184453.300964355 174420.673339844,184456.628051758 174354.13104248,184456.628051758 174294.242858887,184463.282409668 174294.242858887,184538.142456055 174154.503662109,184862.536865234 174302.56060791,184962.350646973 174189.438354492,184944.051452637 173999.792419434,185027.229492188 174004.78314209,185090.444763184 174061.344238281,185161.977722168 174096.279174805,185270.109313965 174109.587585449,185301.716918945 174134.540893555,185363.268737793 174270.95300293,185439.792419434 174299.233520508,185448.110412598 174305.887695312,185544.596923828 174477.234436035,185579.531616211 174505.515014648,185592.840026855 174590.356689453,185619.457214355 174676.861816406,185546.260314941 174698.488037109,185554.578308105 174773.348266602,185631.101989746 174819.927978516,185546.260314941 174997.929138184,185661.046203613 175062.807983398,185745.887695312 174923.068847656,185819.084289551 175002.919799805,185835.720031738 175052.826599121,185945.515014648 175112.714782715,185960.487121582 175031.200195312,185913.907409668 175052.826599121,185847.365112305 175046.172241211,185825.738647461 174997.929138184,185760.859741211 174913.087463379,185739.233520508 174848.208557129,185671.027587891 174771.684631348,185740.897216797 174735.086303711,185744.224243164 174715.123718262,185689.326538086 174585.365966797,185639.41973877 174470.580322266,185654.391845703 174445.626831055,185559.569030762 174384.075012207,185551.251037598 174349.140319824,185641.083435059 174279.270751953,185689.326538086 174299.233520508,185745.887695312 174367.43951416,185968.804870605 174285.925109863,185995.421813965 174187.774963379,186030.356689453 174117.905395508,186066.95501709 174077.979797363,185927.215820312 174024.745910645,185822.411560059 173961.530456543,185704.29864502 173958.203430176,185681.008789062 173974.839172363,185636.092712402 174018.09161377,185596.167358398 174082.970458984,185474.727355957 174194.429077148,185356.614379883 174086.297729492,185388.222229004 174039.718017578,185266.782226562 173979.829833984,185231.847351074 174038.054382324,185110.407531738 173986.483947754,184965.67767334 173921.605102539,184905.789489746 173871.698303223,184957.359924316 173810.146484375,184924.088684082 173726.968444824,184944.051452637 173672.070983887,185007.266723633 173697.024475098,185057.173461914 173630.481933594,185110.407531738 173514.032653809,185052.182800293 173482.425048828,185023.90222168 173529.004760742,184884.163269043 173524.014038086,184840.910644531 173522.350646973,184827.602172852 173505.714904785,184832.592895508 173600.537963867,184875.845336914 173688.706481934,184717.807006836 173781.865905762,184742.760498047 173823.454956055,184726.124938965 173848.408447266,184657.918823242 173855.062561035,184591.376525879 173758.576049805,184528.161071777 173803.492370605,184478.254272461 173746.931274414,184459.955078125 173771.884521484,184381.76776123 173715.323608398,184296.926330566 173830.109313965,184210.420959473 173816.800842285,184143.878662109 173791.847351074,184040.737854004 173951.549316406,184175.486328125 174067.998352051,184113.934509277 174161.157836914,184130.570007324 174182.784240723,184010.793640137 174340.822570801,183994.15814209 174322.5234375,183972.531677246 174322.5234375,183884.36315918 174463.925964355,183638.15612793 174374.09362793,183535.015258789 174342.485961914,183546.66027832 174319.196105957,183491.762634277 174264.29864502,183461.818603516 174162.821472168,183433.538085938 174036.390991211,183431.874450684 173918.278015137,183418.565979004 173818.464233398,183453.500854492 173763.566772461,183493.426269531 173702.015197754,183340.378601074 173514.032653809,183215.611572266 173336.031738281,183150.732666016 173271.152893066,183305.443969727 173038.254272461,183134.097167969 172950.085510254,183109.143676758 172976.702453613,182994.358032227 172896.85168457,183002.842102051 172881.713256836,182940.292114258 172757.944335938,182887.058288574 172696.725158691,182816.523193359 172752.620788574,182712.717102051 172710.033630371,182615.565063477 172849.772766113,182530.39074707 172945.593994141,182578.301513672 173002.82043457,182549.022766113 173046.738342285,182642.182250977 173143.890319824,182662.144836426 173133.243652344,182825.839355469 173272.982849121,182843.140319824 173249.02746582,183000.180297852 173422.037658691,183016.15057373 173420.70690918,183113.30255127 173509.873779297,183159.882263184 173519.189697266,183265.01940918 173837.262573242,183300.952209473 173922.436889648,183398.104187012 173829.27746582,183407.42010498 173903.805114746,183398.104187012 173984.986877441,183395.442443848 174092.785522461,183406.089355469 174126.05682373,183412.743469238 174169.974731445,183508.564697266 174344.315917969,183463.315734863 174385.57232666,183511.22644043 174425.497680664,183455.330627441 174563.906066895,183480.616760254 174583.868652344,183463.315734863 174651.741943359,183508.564697266 174708.968566895,183567.122070312 174645.08782959,183581.761291504 174657.065551758,183559.136962891 174686.343994141,183600.393310547 174719.61529541,183584.423095703 174747.563171387,183615.032592773 174780.834472656,183641.649475098 174851.36932373,183627.010253906 174855.361877441,183561.798522949 174812.774719238,183515.218994141 174880.648010254,183489.932861328 174858.023620605,183414.074462891 174961.829772949,183310.268127441 174896.618225098,183276.997070312 175070.959472656,183246.387390137 175189.404785156,183218.439697266 175309.181152344,183211.785339355 175341.121643066,183085.354614258 175287.887573242,183062.730285645 175326.482421875,182953.600830078 175254.616577148,182921.660339355 175309.181152344,182797.891418457 175247.962219238,182736.672424316 175337.129089355,182734.010681152 175403.671630859,182835.155212402 175451.582092285,182829.83190918 175460.898010254,182948.27722168 175514.132080078,182976.225158691 175474.206481934,183040.105895996 175500.823608398,183202.469421387 175554.057434082,183227.755554199 175605.960510254,183245.05657959 175628.585083008,183246.387390137 175685.811462402,183261.026855469 175731.060424805,183279.658630371 175776.309143066,183261.026855469 175802.926269531,183237.071472168 175809.580383301,183181.175842285 175824.219848633,183109.309997559 175870.799560547,183133.265319824 175953.312133789,183161.21307373 176034.493896484,183237.071472168 176158.262817383,183290.305541992 176248.760498047,183335.554260254 176316.633789062,183370.156311035 176396.484741211,183456.661621094 176335.265808105,183688.229187012 176681.286437988,183772.072753906 176858.28918457,183821.713317871 176955.574279785,183825.972106934 176993.902648926,183856.84777832 177019.45501709,183805.743103027 177173.833435059,183690.757873535 177113.146850586,183569.384521484 177014.131652832,183407.553222656 176892.758300781,183361.772094727 176865.076599121,183317.055541992 176843.78302002,183275.532958984 176834.200927734,183248.91607666 176835.26550293,183213.781616211 176819.295288086,183238.269348145 176786.290405273,183186.100097656 176757.543884277,183258.498168945 176631.911804199,183228.687255859 176593.583435059,183258.498168945 176560.578369141,183100.92578125 176415.782043457,183194.617431641 176319.96081543,183020.010009766 176165.582458496,183009.363342285 176178.358703613,182905.024780273 176093.184143066,182890.119140625 176083.602050781,182834.75592041 176065.502685547,182803.880249023 176028.238830566,182766.616455078 175990.975036621,182701.671081543 175959.034790039,182668.66607666 175953.711425781,182638.854919434 175944.129089355,182604.78527832 175862.148986816,182603.72052002 175811.044311523,182560.068786621 175738.646240234,182441.889404297 175664.118591309,182396.108276367 175669.442138672,182358.844421387 175624.725646973,182257.699890137 175567.232788086,182242.794433594 175598.108459473,182227.889038086 175585.332458496,182193.819152832 175528.904418945,182142.714660645 175489.511230469,182091.609985352 175463.958862305,182083.092468262 175450.118225098,182084.157287598 175433.083435059,182055.411010742 175407.531066895,182038.375976562 175385.172668457,181979.818786621 175344.714904785,181937.231628418 175276.575378418,181878.674194336 175266.993286133,181854.186645508 175257.411193848,181833.957641602 175225.470947266,181672.126525879 175061.510437012,181574.175964355 174956.107116699,181491.130981445 174714.425048828,181480.484313965 174718.683776855,181483.678283691 174770.853027344,181518.812744141 174869.868225098,181569.917175293 174969.947998047,181675.320495605 175097.709472656,181854.186645508 175280.83416748,181924.455322266 175289.35168457,181972.366027832 175362.81451416,182028.793823242 175392.625610352,182070.31640625 175463.958862305,182071.380981445 175511.869567871,182164.008239746 175549.133178711,182184.237060547 175558.715515137,182197.013305664 175581.073669434,182255.570495605 175665.183410645,182269.411376953 175660.924621582,182301.351867676 175714.158508301,182346.068359375 175733.322937012,182373.74987793 175766.327758789,182368.426574707 175800.397583008,182404.625549316 175883.442565918,182491.929260254 175975.005004883,182457.859619141 176034.62701416,182551.551269531 176127.25402832,182453.600891113 176256.080078125,182435.501220703 176253.950683594,182358.844421387 176218.816467285,182303.481201172 176181.55267334,182239.600463867 176091.054992676,182189.56036377 176050.596984863,182233.212341309 175965.422668457,182175.719726562 175923.90032959,182054.346191406 175841.91998291,181997.918151855 175940.935119629,181965.977905273 175927.094299316,181820.116821289 175854.696228027,181740.265808105 175823.820556641,181758.365478516 175771.651306152,181857.380615234 175814.238464355,181934.037414551 175849.372680664,181971.301269531 175778.039245605,181959.589782715 175766.327758789,181976.624572754 175733.322937012,181866.96270752 175673.700683594,181695.549499512 175649.213195801,181710.454956055 175593.849975586,181664.673828125 175566.168212891,181608.245788574 175681.153442383,181525.200866699 175653.471923828,181486.872497559 175738.646240234,181409.150634766 175708.835144043,181362.304931641 175807.850341797,181408.08605957 175839.79083252,181430.444213867 175796.13885498,181504.971862793 175830.208496094,181481.54888916 175890.895263672,181419.797546387 175862.148986816,181399.568786621 175902.606750488,181328.235107422 175863.213562012,181319.717773438 175884.507141113,181124.881408691 175813.17364502,181107.846557617 175794.009460449,181072.712158203 175770.586486816,181070.582946777 175725.869995117,181117.428649902 175525.710449219,181026.931030273 175428.824645996,180952.403564453 175589.591186523,180878.940734863 175494.834777832,180831.030029297 175417.11315918,180833.159423828 175373.461181641,180803.348510742 175372.396606445,180826.771240234 175288.286865234,180768.214111328 175236.117614746,180674.522277832 175193.530456543,180661.74621582 175111.550354004,180648.969909668 175030.634521484,180620.223632812 174936.942932129,180598.930053711 174791.081848145,180527.596557617 174644.15612793,180387.059020996 174497.23046875,180366.83001709 174466.354797363,180284.849914551 174287.488647461,180263.556335449 174292.812194824,180368.959411621 174510.006774902,180510.561767578 174660.126403809,180578.70123291 174802.793334961,180636.193847656 175104.097595215,180657.487426758 175181.818969727,180651.099304199 175206.306762695,180597.865478516 175255.281799316,180681.974975586 175337.262207031,180703.268554688 175314.904052734,180767.149291992 175378.784790039,180753.308410645 175391.560852051,180770.343444824 175703.511779785,180734.144226074 175658.795288086,180598.930053711 175572.556396484,180398.770507812 175492.705383301,180384.929626465 175506.546020508,180555.278259277 175568.297607422,180631.935058594 175608.755371094,180711.786071777 175657.730712891,180717.109436035 175731.19329834,180716.044799805 175748.22833252,180749.049865723 175747.163574219,180736.273620605 175820.626403809,180795.895568848 175831.27331543,180790.572265625 175882.377990723,180965.179626465 175902.606750488,180965.179626465 175971.810852051,181031.189758301 175992.039855957,181040.771850586 175916.447631836,181210.055725098 175965.422668457,181301.618164062 175995.233764648,181315.45904541 175965.422668457,181365.498901367 175983.522338867,181374.016418457 175968.616882324,181470.90222168 175988.84564209,181529.459655762 176006.945251465,181823.310974121 176094.248962402,181896.773803711 176142.159484863,182044.764099121 176234.786499023,182140.585327148 176288.020568848,182282.18762207 176326.348937988,182327.96875 176345.513183594,182356.715087891 176307.184753418,182219.371459961 176274.1796875,182287.510986328 176180.487854004,182334.356933594 176215.622314453,182438.69543457 176267.791564941,182401.43157959 176382.776977539,182417.401855469 176398.747253418,182580.297790527 176466.886535645,182588.815063477 176444.528320312,182636.725585938 176471.145263672,182673.989379883 176491.374267578,182861.37286377 176554.190185547,182832.626525879 176624.459106445,182811.332946777 176675.563781738,182791.104187012 176670.240234375,182769.81060791 176718.150939941,182814.526916504 176749.026611328,182835.820495605 176763.932067871,182852.855529785 176746.897216797,183051.950500488 176824.618835449,183024.268798828 176894.887512207,183058.338623047 176921.504638672,183022.139404297 176966.221191406,183074.308654785 177013.066894531,183094.537658691 177021.584411621,183126.477905273 176975.803039551,183273.403564453 177060.977355957,183467.175170898 177167.445251465,183483.145446777 177173.833435059,183518.279846191 177109.952697754,183808.937255859 177288.818847656,183899.434936523 177388.89855957,183883.464660645 177471.94354248,183880.270751953 177515.595458984,183920.728515625 177562.441162109,183888.788269043 177601.834411621,183883.464660645 177618.86920166,183931.375427246 177667.844482422,183811.066650391 177834.999206543,183804.678527832 177846.710693359,183647.105957031 177934.014343262,183662.01159668 177978.730712891,183588.54876709 177997.895080566,183441.623046875 178028.770812988,183277.662353516 178044.740783691,183253.174804688 178148.014770508,183260.627502441 178297.069824219,183240.398498535 178474.871154785,183232.945800781 178545.140075684,183190.358642578 178699.518432617,183195.682189941 178764.463745117,183219.104919434 178881.578552246,183238.269348145 178985.917114258,183246.786682129 179072.156188965,183287.244445801 179187.141418457,183320.249511719 179214.823120117,183374.548156738 179324.484985352,183411.811950684 179485.251525879,183274.468383789 179567.231872559,183287.244445801 179592.783996582,183205.264282227 179630.047851562,183176.51776123 179659.858947754,183125.413330078 179709.898803711,183096.667053223 179751.421386719,183075.373474121 179806.784606934,183056.209228516 179842.983642578,183027.46270752 179872.79473877,183023.204162598 179899.411621094,183034.915649414 179967.551147461,183021.074829102 180018.655578613,183035.980224609 180072.954223633,183018.94543457 180115.541381836,182976.358276367 180162.387329102,182963.581970215 180180.486938477,182941.223815918 180314.63659668,182854.984924316 180302.925109863,182649.501831055 180305.054443359,182481.282592773 180299.730895996,182405.690368652 180284.825439453,182216.17755127 180315.701171875,182233.212341309 180517.99029541,182182.107666016 180514.796081543,182057.540344238 180593.582458496,182031.988037109 180582.93560791,182033.052612305 180623.393371582,181988.33605957 180629.781494141,181985.142089844 180650.010314941,181754.106689453 180651.075073242,181671.061767578 180631.910888672,181559.270507812 180612.746459961,181435.76776123 180605.293762207,181431.509033203 180628.71673584,181174.921508789 180624.458190918,181161.080627441 180644.686950684,181061.000671387 180646.816345215,181032.254333496 180658.527832031,180944.950622559 180621.263977051,180847.000244141 180621.263977051,180787.378295898 180613.811279297,180767.149291992 180615.940673828,180777.796203613 180540.348449707,180892.78137207 180503.084594727,180980.085083008 180487.114562988,181019.478271484 180495.631896973,181088.682373047 180505.213989258,181163.210021973 180421.104492188,181099.329284668 180278.437316895,180976.891113281 180122.99432373,180934.303955078 180195.39239502,180827.83605957 180185.810302734,180806.542480469 180279.50213623,180789.50769043 180280.566711426,180786.313476562 180302.925109863,180606.382751465 180230.526855469,180580.830383301 180334.865356445,180518.014465332 180533.960266113,180477.55670166 180636.169677734,180473.297912598 180642.557556152,180493.526916504 180671.303894043,180505.23840332 180698.985595703,180424.322631836 180720.279174805,180388.123596191 180731.990661621,180264.620910645 180736.249389648,180289.108398438 180675.56262207,179929.246948242 180701.114990234,179732.28137207 180609.552490234,179616.231384277 180544.607177734,179639.65435791 180525.442993164,179660.947937012 180497.761291504,179687.564819336 180482.855834961,179722.699279785 180455.174133301,179740.79888916 180446.656616211,179755.704345703 180434.945129395,179771.674560547 180417.91027832,179799.356079102 180428.557189941,179917.535461426 180477.532287598,179963.316833496 180411.522338867,179968.640136719 180384.905212402,180048.491149902 180263.531860352,180130.471252441 180276.307922363,180213.516235352 180265.661254883,180262.491516113 180245.432250977,180317.854736328 180148.546447754,180355.118530273 180011.202880859,180415.805358887 179926.028808594,180448.81036377 179861.083251953,180553.148925781 179886.635559082,180626.611755371 179811.043395996,180644.711120605 179799.33190918,180563.795593262 179714.157592773,180460.521850586 179679.023132324,180415.805358887 179664.117675781,180387.059020996 179688.605224609,180342.342468262 179694.993347168,180327.437072754 179701.381530762,180246.521240234 179686.475830078,180251.844848633 179665.182250977,180216.710388184 179659.858947754,180213.516235352 179641.759338379,179995.257080078 179609.819030762,179910.082763672 179583.202148438,179907.953369141 179549.132263184,179846.202026367 179509.739318848,179782.321289062 179470.346069336,179746.122253418 179534.226806641,179684.370910645 179501.221740723,179655.624572754 179573.620056152,179551.285827637 179503.351135254,179481.017211914 179503.351135254,179462.917541504 179550.196838379,179446.94732666 179595.978210449,179443.753356934 179617.271789551,179455.46484375 179664.117675781,179494.858032227 179698.187316895,179527.863098145 179755.679931641,179542.768554688 179811.043395996,179567.256103516 179854.695129395,179657.753723145 179988.844726562,179698.211730957 180034.625854492,179664.141906738 180085.730529785,179607.713867188 180163.452148438,179507.634094238 180307.183654785,179393.713500977 180253.949768066,179301.086425781 180174.098815918,179254.240539551 180241.173706055,179132.8671875 180138.964355469,179035.981384277 180104.894714355,178934.836853027 180022.914367676,178911.413879395 179999.491394043,178886.926330566 179975.003845215,178814.528076172 179932.416687012,178790.040527344 179928.157958984,178802.816589355 179788.684997559,178828.36895752 179775.908935547,178846.468566895 179607.689697266,178943.354370117 179620.465698242,179058.339538574 179621.530517578,179089.215209961 179633.242004395,179129.673034668 179638.565368652,179148.837219238 179625.789306641,179150.96661377 179590.654846191,179223.364868164 179567.231872559,179264.887207031 179584.266723633,179302.151000977 179525.709289551,179336.22064209 179472.475463867,179395.842895508 179457.569824219,179451.206115723 179417.111999512,179516.151611328 179371.330932617,179492.72869873 179341.519836426,179391.584106445 179261.669067383,179396.907470703 179210.56439209,179369.225708008 179200.98223877,179406.489562988 179105.161071777,179352.190917969 179083.867492676,179339.414855957 179109.419799805,179203.135864258 179038.086364746,179253.175720215 178917.777587891,179296.827697754 178783.628173828,179306.409790039 178749.558349609,179269.145996094 178745.299560547,179237.205688477 178750.62310791,179227.623596191 178675.030883789,179229.752746582 178647.349182129,179240.399658203 178619.667480469,179148.837219238 178599.438659668,179214.847351074 178558.980895996,179182.907043457 178491.906005859,179196.747924805 178495.100158691,179199.941894531 178479.129943848,179175.454345703 178448.254272461,179182.907043457 178415.249206543,179168.001647949 178401.408325195,179206.33001709 178333.268798828,179278.728088379 178248.094482422,179213.782775879 178212.960083008,179226.558837891 178196.99005127,179179.712890625 178169.308349609,179216.97668457 178090.522155762,179246.787780762 178031.96472168,178996.588195801 177921.238098145,178990.200073242 177971.277954102,178895.443603516 177947.854980469,178895.443603516 177920.173522949,178802.816589355 177911.656005859,178797.493225098 178077.745849609,178758.100036621 178097.974853516,178717.642272949 178122.462402344,178704.866210938 178150.144104004,178753.841308594 178182.084411621,178710.189575195 178245.965148926,178758.100036621 178285.358337402,178913.543273926 178412.054992676,178941.224731445 178405.667114258,178974.229797363 178418.44317627,179037.045959473 178461.030334473,179090.280029297 178503.617492676,179107.314819336 178533.428588867,179123.284851074 178595.179931641,179078.56854248 178631.378967285,179017.881774902 178709.100524902,179062.598327637 178733.58807373,179053.016235352 178750.62310791,179189.295227051 178809.180297852,179154.160766602 178887.96673584,179097.732727051 178859.220397949,179058.339538574 178955.041381836,179109.444213867 178972.07623291,179079.633117676 179040.215698242,179131.802368164 179078.544128418,179107.314819336 179180.753295898,178946.548278809 179180.753295898,178933.772277832 179253.151550293,178823.045593262 179206.305603027,178774.0703125 179200.98223877,178684.637207031 179189.270812988,178621.821289062 179193.529541016,178621.821289062 179243.569458008,178486.606872559 179261.669067383,178498.31829834 179315.967712402,178499.383117676 179345.778564453,178580.298706055 179356.425476074,178524.93548584 179528.903259277,178309.870300293 179506.54510498,178288.576721191 179601.301513672,178239.601379395 179594.913635254,178066.058837891 179565.102478027,178060.735229492 179523.579956055,178017.083496094 179513.997802734,178017.083496094 179468.21673584,177996.854492188 179465.022521973,178001.11328125 179444.793762207,177990.46661377 179438.405578613,178016.018920898 179334.067077637,177990.46661377 179328.743774414,178007.501403809 179278.703857422,178031.988952637 179280.833251953,178049.023742676 179199.917663574,178053.282531738 179177.559326172,178109.710571289 179207.370422363,178132.068908691 179136.03692627,178141.651000977 179119.00189209,178186.367553711 179121.131286621,178185.30279541 179109.419799805,178214.049072266 179111.549194336,178212.98449707 179137.101501465,178373.751037598 179136.03692627,178418.467590332 179134.972167969,178418.467590332 179097.708312988,178470.63684082 179106.225830078,178488.736206055 179027.439697266,178643.114868164 179013.598815918,178697.413513184 179004.016723633,178806.010742188 178992.305236816,178868.826721191 178990.175842285,178898.637573242 178894.354614258,178911.413879395 178866.673156738,178862.438598633 178863.478942871,178824.110168457 178867.737731934,178747.453369141 178843.250183105,178656.955505371 178834.732666016,178517.482727051 178805.986328125,178441.89050293 178803.856994629,178433.37298584 178873.061035156,178408.885498047 178867.737731934,178406.756103516 178846.444152832,178289.641296387 178828.344482422,178302.417541504 178745.299560547,178249.183532715 178734.652893066,178232.148681641 178849.638061523,178175.72064209 178840.055969238,178171.461914062 178871.996459961,178061.800048828 178860.284973145,178050.088562012 178856.026245117,178037.3125 178988.046447754,178034.118347168 179042.345092773,178060.735229492 179048.733276367,178041.571289062 179122.196105957,178064.994018555 179130.713378906,178057.541259766 179158.395080566,178008.565979004 179141.360290527,177989.401794434 179187.141418457,178011.760192871 179195.658935547,177994.725341797 179230.793395996,177965.978820801 179229.72857666,177947.879455566 179258.474853516,177935.103149414 179299.997436523,177925.521057129 179384.106994629,177908.486206055 179538.485595703,177841.411499023 179523.579956055,177853.12298584 179380.913024902,177823.311889648 179390.495117188,177842.476135254 179273.380554199,177852.058227539 179193.529541016,177869.093017578 179106.225830078,177800.953735352 179084.932250977,177771.14263916 179211.628967285,177657.222045898 179205.241027832,177623.152160645 179199.917663574,177578.435852051 179366.007568359,177517.749084473 179348.97277832,177501.778808594 179351.101928711,177481.550048828 179396.883239746,177474.097351074 179434.147094727,177404.893005371 179408.594726562,177367.629455566 179549.132263184,177351.659179688 179616.207214355,177287.778442383 179594.913635254,177278.196350098 179611.948425293,177226.027099609 179588.52545166,177235.609191895 179560.84375,177188.763244629 179533.16204834,177272.87298584 179354.296081543,177187.698669434 179311.70892334,177134.464599609 179253.151550293,177184.823974609 179195.126525879,177118.387878418 179162.760375977,177172.047912598 179072.475402832,177103.90838623 179037.553955078,177128.608886719 178983.042541504,177066.43157959 178967.711181641,177010.216552734 178946.417602539,176976.146911621 178913.199584961,176867.123718262 178862.946777344,176828.795288086 178835.690979004,176805.798278809 178730.926513672,176740.214050293 178656.824829102,176690.812866211 178622.755187988,176630.339050293 178600.609741211,176585.196777344 178584.426574707,176541.7578125 178554.615661621,176511.946899414 178517.138916016,176429.327697754 178466.034423828,176356.929626465 178426.002319336,176325.415039062 178415.781616211,176128.662475586 178345.938598633,176046.043212891 178315.275878906,175723.23260498 178239.470703125,175459.192321777 178173.034667969,175351.020751953 178144.927246094,175232.628417969 178065.715148926,175139.788635254 177999.27911377,175023.951416016 177902.180358887,174941.332397461 178012.055175781,175098.904968262 178101.48828125,175071.649169922 178184.959106445,175064.835083008 178236.063781738,174993.288696289 178311.017150879,174976.253845215 178329.755432129,174910.669677734 178442.185546875,174848.492370605 178644.900390625,174805.905212402 178638.086547852,174913.475280762 179046.289733887,175054.837402344 179055.819885254,175154.108459473 179074.879821777,175262.115478516 179116.97088623,175301.823913574 179107.440673828,175268.46887207 179210.682739258,175243.849731445 179213.065307617,175240.672973633 179254.362182617,175276.410644531 179264.686340332,175270.057250977 179300.423828125,175324.854858398 179293.276428223,175478.923706055 179322.660766602,175679.054199219 179362.369018555,175798.17956543 179504.525268555,175868.860717773 179600.619750977,175956.219238281 179734.040283203,176256.987609863 180111.914245605,176353.931884766 180013.030883789,176499.348632812 180069.258666992,176540.065307617 180065.380737305,176423.731994629 180350.397583008,176297.704284668 180443.464416504,176237.598571777 180530.714172363,176016.565185547 180935.942077637,175950.643066406 181009.619873047,176016.565185547 181092.9921875,176014.897827148 181109.007263184,175991.320861816 181123.898010254,175954.094238281 181143.752319336,175921.830993652 181167.329284668,175892.049804688 181184.701599121,175810.027038574 181116.825012207,175681.967224121 181233.96484375,175485.410400391 181410.667541504,175501.293762207 181485.120849609,175459.600036621 181529.792907715,175442.723815918 181554.610717773,175356.357971191 181655.867248535,175392.09564209 181743.225952148,175416.913391113 181767.050842285,175440.73828125 181778.963378906,175498.315612793 181944.746154785,175434.782226562 181978.498352051,175318.635009766 182038.061157227,175221.349243164 182052.951843262,175054.573608398 182099.609191895,174891.768981934 182187.960571289,174854.046020508 182406.356994629,174850.075256348 182627.731506348,174846.104248047 182701.192138672,174793.490600586 182811.383117676,174759.73840332 182896.756347656,174756.760314941 182988.08581543,174731.942504883 183056.582824707,174696.204833984 183097.284118652,174653.518493652 183114.160095215,174602.890075684 183119.123718262,174550.276428223 183114.160095215,174504.611694336 183083.386047363,174482.772094727 183052.611999512,174463.910583496 183064.524597168,174447.034362793 183104.233032227,174432.143676758 183173.722900391,174409.311401367 183235.270996094,174409.311401367 183271.008422852,174389.457092285 183327.593078613,174273.309875488 183282.921020508,174249.484924316 183436.79119873,174267.35357666 183438.776733398,174273.309875488 183501.317626953,174309.047546387 183510.251831055,174296.142333984 183534.076965332,174313.018310547 183546.98236084,174298.127624512 183613.493896484,174303.091247559 183622.428283691,174277.280822754 183692.910827637,174464.903198242 183703.830749512,174455.968811035 183846.78125,174446.041748047 183885.496826172,174509.575134277 183903.365661621,174496.669921875 183981.789978027,174433.136352539 183970.870056152,174388.464477539 184203.164489746,174276.287963867 184247.836364746,174194.885803223 184239.894836426,174182.973205566 184356.042053223,174595.03894043 184450.282165527)))' );
        $this->assertEquals( -1, $this->testMultiPoly->getSrid( ) );
        $this->assertFalse( $this->testMultiPoly->isEmpty( ) ); 
        foreach ( $this->testMultiPoly->getPolygons( ) as $p ) {
            $this->assertFalse( $p->isEmpty(  ) );
        }
    }

    /**
     * testPolygonWithSpaces 
     * 
     * Gaat na of de parser omkan met spaties.
     * @access  public
     * @return  void
     */
    function testPolygonWithSpaces(  )
    {
        $this->testMultiPoly->setGeometryFromText(
                            'MULTIPOLYGON( ( (178000.25 212000.35, 178100.50 212003.55, 180560 212100)), ((158000.25 200000.35, 158105.50 200203.55, 160560 200100), (160 250, 400 500, 210 321) ) )');

        $this->assertEquals( (string) $this->testMultiPoly, 
                            'MULTIPOLYGON(((178000.25 212000.35, 178100.50 212003.55, 180560 212100)), ((158000.25 200000.35, 158105.50 200203.55, 160560 200100), (160 250, 400 500, 210 321)))'
                            );
    }

}
?>
